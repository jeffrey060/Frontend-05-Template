å­¦ä¹ ç¬”è®°

æŒç»­é›†æˆ - å‘å¸ƒå‰æ£€æŸ¥   

æœ€ç»ˆé˜¶æ®µé›†æˆï¼šå‰é¢å„è‡ªå¼€å‘ï¼Œæœ€ç»ˆé›†æˆè”è°ƒ   
åœ¨æŒç»­é›†æˆè¢«æå‡ºä¹‹å‰ï¼Œå®¢æˆ·ç«¯ä¸»è¦çš„å¼€å‘æ¨¡å¼å°±æ˜¯æœ€ç»ˆé˜¶æ®µé›†æˆ   

æŒç»­é›†æˆæ¦‚å¿µï¼š
* daily buildï¼šæ¯å¤©æ™šä¸Šå…¨å±€buildä¸€æ¬¡ï¼Œæ˜¯å¦å¯ä»¥buildæˆåŠŸ
* BVTï¼šbuild verification testï¼Œæ„å»ºçš„éªŒè¯æµ‹è¯•ï¼Œå±äºä¸€ç§å†’çƒŸæµ‹è¯•ï¼Œæµ‹è¯•caseä¸€èˆ¬éƒ½æ˜¯æœ€åŸºæœ¬æœ€ç®€å•çš„caseï¼Œå¯¹buildæˆåŠŸä¹‹åçš„ç»“æœè¿›è¡Œä¸€ä¸ªåŸºæœ¬çš„éªŒè¯

å¯¹äºå‰ç«¯æ¥è¯´ï¼Œbuildæ—¶é—´ç›¸å¯¹è¾ƒçŸ­ï¼Œå¯ä»¥é€‰æ‹©åœ¨æäº¤çš„æ—¶å€™è¿›è¡Œbuildå’ŒåŸºæœ¬çš„éªŒè¯   
äº’è”ç½‘ä¼ä¸šä¸€èˆ¬1-2å‘¨çš„ä¸Šçº¿å‘¨æœŸ   

åœ¨å®¢æˆ·ç«¯æ—¶ä»£ï¼ŒBVTæ˜¯ç”±æµ‹è¯•å·¥ç¨‹å¸ˆæ¥æä¾›ï¼Œå±äºend to endçš„æµ‹è¯•ï¼Œä¼šæ¶‰åŠä¸€äº›UIä¸Šé¢çš„æ“ä½œï¼Œæ‰€ä»¥ä¸€èˆ¬å•å…ƒæµ‹è¯•æ˜¯æ²¡æœ‰åŠæ³•è¦†ç›–çš„  
æµ‹è¯•å·¥ç¨‹å¸ˆäº§ç”Ÿcaseçš„æˆæœ¬é«˜ï¼Œå¯¹äºå‰ç«¯è¿™ç§çŸ­å‘¨æœŸçš„å¼€å‘æ¥è¯´ï¼Œä¸å¤ªåˆé€‚

é‡‡ç”¨ä¸€ç§æ›´è½»é‡çº§çš„æ£€æŸ¥æ–¹å¼ï¼š
* lintï¼šå¯¹ä»£ç é£æ ¼å’Œä¸€äº›å¸¸è§çš„ä»£ç æ¨¡å¼åšä¸€äº›æ ¡éªŒ
å¦‚æœæƒ³è¦åšæ¯”è¾ƒå®Œæ•´çš„æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨PhantomJSæ— å¤´æµè§ˆå™¨è¿›è¡Œæµ‹è¯•   

å‰ç«¯åšæŒç»­é›†æˆï¼Œå¯ä»¥åˆ©ç”¨æ— å¤´æµè§ˆå™¨æŠŠæ•´æ£µDOMæ ‘ç”Ÿæˆå‡ºæ¥,ç„¶åæ£€æŸ¥DOMæ ‘é‡Œé¢ç‰¹å®šçš„æŸäº›æ ¼å¼   
DOMæ ‘é‡Œå¯ä»¥é€šè¿‡CSSOMæ‹¿åˆ°å…ƒç´ çš„ä½ç½®ï¼ŒèƒŒæ™¯å›¾ä»¥åŠå…ƒç´ çš„ä¸€äº›ç»“æ„   
å®¢è§‚ä¸Šï¼Œä½¿ç”¨æ— å¤´æµè§ˆå™¨ï¼Œå¯ä»¥é…åˆä¸€äº›è§„åˆ™æ ¡éªŒï¼Œæœ€åå®ŒæˆBVTä»»åŠ¡   

* é€šè¿‡Git Hookæ¥å®Œæˆæ£€æŸ¥çš„æ—¶æœº
* ESLintï¼šè½»é‡çº§ä»£ç æ£€æŸ¥æ–¹æ¡ˆ
* PhantomJSï¼ˆDeprecatedï¼‰ï¼šåŸºäºæ— å¤´æµè§ˆå™¨å¯¹ä»£ç æœ€åç”Ÿæˆå‡ºæ¥çš„æ ·å­ï¼Œåšä¸€äº›è§„åˆ™çš„æ ¡éªŒå’Œæ£€æŸ¥
* Chrome Headlessæ¨¡å¼ - puppeteeråº“

.git/hook/*.sample
* applypatch-msg.sample
* commit-msg.sample
* fsmonitor-watchman.sample
* post-update.sample
* pre-applypatch.sample
* pre-commit.sampleï¼šlintä¹‹ç±»çš„æ“ä½œä¼šæ”¾åˆ°pre-commité‡Œé¢
* pre-push.sampleï¼šæœ€ç»ˆcheckçš„æ“ä½œæ”¾åˆ°pre-pushé‡Œé¢
* pre-rebase.sample
* pre-receive.sampleï¼š
* prepare-commit-msg.sample
* update.sample
å»æ‰.sampleåç¼€ï¼Œå˜ä¸ºlinuxå¯æ‰§è¡Œæ–‡ä»¶ï¼Œshellè„šæœ¬ç¼–å†™
```sh
$ which node
/usr/local/bin/node

$ ls -l ./pre-commit
-rw-r--r-- ./pre-commit

$ chmod +x ./pre-commit

$ ls -l ./pre-commit
-rwxr-xr-x ./pre-commit
```
./pre-commit:
```js
#!/usr/bin/env node
let process = require("process");

console.log("Hello Hooks!");

process.exitCode = 1;
```
git hooks æ˜¯æœ¬åœ°çš„ï¼Œæ— æ³•cloneã€‚å¯ä»¥å€ŸåŠ© https://github.com/typicode/husky æ¥ä¿è¯æ¯ä¸ªäººéƒ½æœ‰hooks   

ESLint åŸºæœ¬ç”¨æ³•:
- å®‰è£…
  ```
    npm install eslint --save-dev
  ```  
  ğŸ’¡ ä¸€å®šæ˜¯--save-dev
- åˆå§‹åŒ–
  ```
    npx eslint --init
  ```  
  ä¼šç”Ÿæˆé…ç½®æ–‡ä»¶`.eslintrc.js`
- ç”¨æ³•
  ```
    npx eslint yourfile.js
  ```
- ğŸ’¡ æ£€æŸ¥éœ€è¦æäº¤çš„ç‰ˆæœ¬è€Œä¸ä¸€å®šæ˜¯ç°åœ¨æ–‡ä»¶å‘ˆç°çš„ç‰ˆæœ¬ã€‚éœ€è¦ç”¨åˆ°gitçš„ä¸€ä¸ªå‘½ä»¤  `git stash push -k`

Gitä¸ESLintç»“åˆ
git addåæ‰‹åŠ¨ä¿®æ”¹ä»£ç ï¼Œå¯¼è‡´eslintæ ¡éªŒä¿®æ”¹åçš„ä»£ç ï¼Œè€Œä¸æ˜¯å·²addçš„ä»£ç    
git stash
```sh
$ git stash push -k
$ git stash list
$ git stash pop
```
å¯ä»¥ç”¨child processå»æ”¾åˆ°hooksé‡Œé¢å»ï¼Œæˆ–è€…è®©ç”¨æˆ·å»å­¦ä¹ git stashå‘½ä»¤   
```js
#!/usr/bin/env node
let process = require("process");
let child_process = require("child_process");
const {ESlint, ESLint} = require("eslint");

function exec(name) {
  return new Promise(function(resolve) {
    child_process.exec(name, resolve);
  });
}

(async function main() {
  const eslint = new ESLint({fix: false});

  await exec("git stash push -k");  
  const results = await eslint.lintFiles(["**/git-demo/index.js"]);
  await exec("git stash pop");

  const formatter = await eslint.loadFormatter("stylish");
  const resultText = formatter.format(results);

  console.log(resultText);
  
  for (let result of results) {
    if (result.errorCount) {
      process.exitCode = 1;
    }
  }
})().catch((error) => {
  process.exitCode = 1;
  console.error(error);
});
```

æœåŠ¡ç«¯çš„gitç³»ç»Ÿå¤šæ•°æä¾›äº†ä¸€ä¸ªweb hooksçš„èƒ½åŠ›   
web hooksä¸æ˜¯gitæœ¬èº«çš„èƒ½åŠ›ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µå»è·å–å®ƒçš„API  

æœåŠ¡ç«¯æ£€æŸ¥å…·æœ‰å¼ºåˆ¶æ€§   
å®¢æˆ·ç«¯æ£€æŸ¥é˜²å›å­ä¸é˜²å°äººï¼Œå¯ä»¥ç»•è¿‡   

Chrome Headlessæ¨¡å¼   
https://developers.google.com/web/updates/2017/04/headless-chrome?hl=en

Chrome puppeteeråº“  
```sh
$ npm i puppeteer
```
```js
const puppeteer = require('puppeteer');

(async () => {
  const browser = await puppeteer.launch();
  const page = await browser.newPage();
  await page.goto('http://localhost:8080/main.html');
  const a = await page.$('a');
  console.log(await a.asElement.boxModel());

  const img = await page.$$('a');
  console.log(img);
})();

```
*æ— å¤´æµè§ˆå™¨
  1. å¯ä»¥åœ¨æ— GUIçš„çŠ¶æ€ä¸‹æ¨¡ä»¿æµè§ˆå™¨è®¿é—®é¡µé¢ï¼Œå¹¶æä¾›APIç»™ç¨‹åºå‘˜è°ƒè¯•æ¸²æŸ“ç»“æœçš„å·¥å…·
  1. chromiumç³»æµè§ˆå™¨å¯æ·»åŠ `--headless`å‚æ•°æ¥å¯åŠ¨æ— å¤´æµè§ˆå™¨æ¨¡å¼
  1. å¯ä»¥ä½¿ç”¨Nodeæ¨¡å—`puppeteer`æ¥è®¿é—®Chromiumæ— å¤´æµè§ˆå™¨çš„APIç”¨äºè°ƒè¯•æ¸²æŸ“ç»“æœï¼Œä»¥æ–¹ä¾¿çš„ç¼–å†™é›†æˆæµ‹è¯•å’ŒéªŒè¯è„šæœ¬